

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Working with KIWI &mdash; kiwi 9.18.34 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Image Description" href="working_with_kiwi/xml_description.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> kiwi
          

          
            
            <img src="_static/kiwi-logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#before-you-start">Before you start</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#choose-a-first-image">Choose a First Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#build-your-first-image">Build your First Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#run-your-image">Run your Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#tweak-and-customize-your-image">Tweak and Customize your Image</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation-from-obs">Installation from OBS</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation-from-your-distribution-s-repositories">Installation from your distribution’s repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation-from-pypi">Installation from PyPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#example-appliance-descriptions">Example Appliance Descriptions</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Working with KIWI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="working_with_kiwi/xml_description.html">The Image Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_kiwi/xml_description.html#the-image-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">image</span></code> Element</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_kiwi/xml_description.html#the-description-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">description</span></code> Element</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_kiwi/xml_description.html#the-preferences-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">preferences</span></code> Element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_kiwi/xml_description.html#build-types">Build Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="working_with_kiwi/xml_description.html#common-attributes-of-the-type-element">Common attributes of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code> element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="working_with_kiwi/xml_description.html#common-elements">Common Elements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_kiwi/xml_description.html#image-profiles">Image Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_kiwi/xml_description.html#adding-users">Adding Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_kiwi/xml_description.html#defining-repositories-and-adding-or-removing-packages">Defining Repositories and Adding or Removing Packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_kiwi/xml_description.html#adding-repositories">Adding repositories</a><ul>
<li class="toctree-l4"><a class="reference internal" href="working_with_kiwi/xml_description.html#supported-repository-paths">Supported repository paths</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="working_with_kiwi/xml_description.html#adding-and-removing-packages">Adding and removing packages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="working_with_kiwi/xml_description.html#the-package-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">package</span></code> element</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_kiwi/xml_description.html#the-archive-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">archive</span></code> element</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_kiwi/xml_description.html#uninstall-system-packages">Uninstall System Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_kiwi/xml_description.html#the-product-and-namedcollection-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">product</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">namedCollection</span></code> element</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_kiwi/xml_description.html#the-ignore-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">ignore</span></code> element</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_kiwi/shell_scripts.html">User Defined Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_kiwi/shell_scripts.html#image-customization-via-the-config-sh-shell-script">Image Customization via the <code class="docutils literal notranslate"><span class="pre">config.sh</span></code> Shell Script</a><ul>
<li class="toctree-l4"><a class="reference internal" href="working_with_kiwi/shell_scripts.html#configuration-tips">Configuration Tips</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="working_with_kiwi/shell_scripts.html#image-customization-via-the-images-sh-shell-script">Image Customization via the <code class="docutils literal notranslate"><span class="pre">images.sh</span></code> Shell Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_kiwi/shell_scripts.html#functions-and-variables-provided-by-kiwi">Functions and Variables Provided by KIWI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="working_with_kiwi/shell_scripts.html#provided-functions">Provided Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_kiwi/shell_scripts.html#profile-environment-variables">Profile Environment Variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_kiwi/runtime_configuration.html">The Runtime Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="working_with_kiwi/customize_the_boot_process.html">Customizing the Boot Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_kiwi/customize_the_boot_process.html#boot-image-hook-scripts">Boot Image Hook-Scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_kiwi/customize_the_boot_process.html#boot-image-parameters">Boot Image Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="working_with_kiwi/customize_the_boot_process.html#boot-debugging">Boot Debugging</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_kiwi/legacy_kiwi.html">Legacy KIWI vs. Next Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_kiwi/legacy_kiwi.html#when-do-i-need-to-use-the-legacy-kiwi">When Do I need to use the legacy kiwi</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_kiwi/legacy_kiwi.html#dropped-features">Dropped Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_kiwi/legacy_kiwi.html#compatibility">Compatibility</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#image-building-process">Image Building Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-prepare-step">The Prepare Step</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-create-step">The Create Step</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="overview/workflow.html">Basic Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="overview/workflow.html#components-of-an-image-description">Components of an Image Description</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#conceptual-overview">Conceptual Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#terminology">Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="overview.html#system-requirements">System Requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="building.html">Building Images</a><ul>
<li class="toctree-l2"><a class="reference internal" href="building/build_live_iso.html">Build an ISO Hybrid Live Image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="building/build_live_iso.html#decision-for-a-live-iso-technology">Decision for a live ISO technology</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="building/build_vmx_disk.html">Build a Virtual Disk Image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="building/build_vmx_disk.html#modifying-the-size-of-the-image">Modifying the Size of the Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_vmx_disk.html#customizing-the-virtual-machine">Customizing the Virtual Machine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="building/build_vmx_disk.html#modifying-the-vm-configuration-directly">Modifying the VM Configuration Directly</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/build_vmx_disk.html#adding-network-interfaces-to-the-vm">Adding Network Interfaces to the VM</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/build_vmx_disk.html#specifying-disks-and-disk-controllers">Specifying Disks and Disk Controllers</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/build_vmx_disk.html#adding-cd-dvd-drives">Adding CD/DVD Drives</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="building/build_oem_disk.html">Build an OEM Expandable Disk Image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="building/build_oem_disk.html#deployment-methods">Deployment Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_oem_disk.html#manual-deployment">Manual Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_oem_disk.html#cd-dvd-deployment">CD/DVD Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_oem_disk.html#network-deployment">Network Deployment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="building/build_pxe_root_filesystem.html">Build a PXE Root File System Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="building/build_docker_container.html">Build a Docker Container Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="building/build_containerized.html">Building in a Self-Contained Environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#installing-and-setting-up-dice">Installing and Setting up Dice</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#installing-and-setting-up-docker">Installing and Setting up Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#installing-and-setting-up-the-build-container">Installing and Setting up the Build Container</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#installing-and-setting-up-vagrant">Installing and Setting up Vagrant</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#configuring-dice">Configuring Dice</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#selecting-a-kiwi-template">Selecting a KIWI Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#the-dicefile">The Dicefile</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#building-with-dice">Building with Dice</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#buildsystem-backends">Buildsystem Backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#building-with-the-host-buildsystem">Building with the Host Buildsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#id1">The Dicefile</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#building-with-the-vagrant-buildsystem">Building with the Vagrant Buildsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#id2">The Dicefile</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#the-vagrant-setup-for-the-docker-provider">The Vagrant setup for the Docker Provider</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#the-vagrantfile">The Vagrantfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#the-vagrant-setup-for-the-libvirt-provider">The Vagrant setup for the libvirt Provider</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#the-vagrant-build-box">The Vagrant Build Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_containerized.html#id3">The Vagrantfile</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="building/build_with_profiles.html">Building Images with Profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="building/build_with_profiles.html#local-builds">Local Builds</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_with_profiles.html#building-with-the-open-build-service">Building with the Open Build Service</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="building/build_in_buildservice.html">Building in the Open Build Service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="building/build_in_buildservice.html#advantages-of-using-the-open-build-service-obs">Advantages of using the Open Build Service (OBS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_in_buildservice.html#differences-between-building-locally-and-on-obs">Differences Between Building Locally and on OBS</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/build_in_buildservice.html#recommendations">Recommendations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="building/build_in_buildservice.html#working-with-obs">Working with OBS</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/build_in_buildservice.html#repository-configuration">Repository Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/build_in_buildservice.html#project-configuration">Project Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="building/working_with_images.html">Working with Images</a><ul>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/iso_to_usb_stick_deployment.html">Deploy ISO Image on an USB Stick</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/iso_to_usb_stick_file_based_deployment.html">Deploy ISO Image as File on a FAT32 Formated USB Stick</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/vmx_setup_for_ec2.html">KIWI Image Description for Amazon EC2</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/vmx_setup_for_azure.html">KIWI Image Description for Microsoft Azure</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/vmx_setup_for_google.html">KIWI Image Description for Google Compute Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/setup_pxe_bootserver.html">Setting Up a Network Boot Server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/setup_pxe_bootserver.html#installing-and-configuring-atftp">Installing and Configuring atftp</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/setup_pxe_bootserver.html#installing-and-configuring-dhcp">Installing and Configuring DHCP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/setup_yast_on_first_boot.html">Setting Up YaST at First Boot</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/pxe_client_configuration.html">PXE Client Setup Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/pxe_client_configuration.html#setup-client-with-remote-root">Setup Client with Remote Root</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/pxe_client_configuration.html#setup-client-with-system-on-local-disk">Setup Client with System on Local Disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/pxe_client_configuration.html#setup-client-with-system-on-local-md-raid-disk">Setup Client with System on Local MD RAID Disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/pxe_client_configuration.html#setup-loading-of-custom-configuration-file-s">Setup Loading of Custom Configuration File(s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/pxe_client_configuration.html#setup-client-to-force-reload-image">Setup Client to Force Reload Image</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/pxe_client_configuration.html#setup-client-to-force-reload-configuration-files">Setup Client to Force Reload Configuration Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/pxe_client_configuration.html#setup-client-for-reboot-after-deployment">Setup Client for Reboot After Deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/pxe_client_configuration.html#setup-custom-kernel-boot-options">Setup custom kernel boot options</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/pxe_client_configuration.html#setup-a-custom-boot-timeout">Setup a Custom Boot Timeout</a></li>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/pxe_client_configuration.html#setup-a-different-download-protocol-and-server">Setup a Different Download Protocol and Server</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/vmx_vagrant_setup.html">KIWI Image Description for Vagrant</a><ul>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/vmx_vagrant_setup.html#customizing-the-embedded-vagrantfile">Customizing the embedded Vagrantfile</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/pxe_live_iso_boot.html">Booting a Live ISO Image from Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/oem_ramdisk_deployment.html">Deploy and Run System in a RamDisk</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/custom_partitions.html">Custom Disk Partitions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="building/working_with_images/custom_partitions.html#custom-partitioning-at-boot-time">Custom Partitioning at Boot Time</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/custom_volumes.html">Custom Disk Volumes</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/custom_fstab_extension.html">Add or Update the Fstab File</a></li>
<li class="toctree-l3"><a class="reference internal" href="building/working_with_images/vmx_setup_for_luks.html">KIWI Image Description Encrypted Disk</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="building.html#supported-distributions">Supported Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="building.html#supported-platforms-and-architectures">Supported Platforms and Architectures</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">KIWI Commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="commands/kiwi.html">kiwi</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/kiwi.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/kiwi.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/kiwi.html#global-options">GLOBAL OPTIONS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/kiwi.html#example">EXAMPLE</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/kiwi.html#the-runtime-configuration-file">The Runtime Configuration File</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/kiwi.html#compatibility">COMPATIBILITY</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/result_list.html">kiwi result list</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/result_list.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/result_list.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/result_list.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/result_bundle.html">kiwi result bundle</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/result_bundle.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/result_bundle.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/result_bundle.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/system_prepare.html">kiwi system prepare</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/system_prepare.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_prepare.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_prepare.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/system_update.html">kiwi system update</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/system_update.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_update.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_update.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/system_build.html">kiwi system build</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/system_build.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_build.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_build.html#options">OPTIONS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_build.html#uri-types">URI_TYPES</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/system_create.html">kiwi system create</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/system_create.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_create.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/system_create.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/image_resize.html">kiwi image resize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/image_resize.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/image_resize.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/image_resize.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="commands/image_info.html">kiwi image info</a><ul>
<li class="toctree-l3"><a class="reference internal" href="commands/image_info.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/image_info.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="commands/image_info.html#options">OPTIONS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development and Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="development/kiwi_from_python.html">Using KIWI NG in a Python Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="development/api/kiwi.html">API Documentation 9.18.34</a><ul>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.archive.html">kiwi.archive Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.boot.html">kiwi.boot Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.bootloader.html">kiwi.bootloader Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.builder.html">kiwi.builder Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.container.html">kiwi.container Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.filesystem.html">kiwi.filesystem Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.iso_tools.html">kiwi.iso_tools Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.package_manager.html">kiwi.package_manager Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.partitioner.html">kiwi.partitioner Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.repository.html">kiwi.repository Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.storage.html">kiwi.storage Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.system.html">kiwi.system Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.solver.html">kiwi.solver Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.tasks.html">kiwi.tasks package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.utils.html">kiwi.utils Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="development/api/kiwi.volume_manager.html">kiwi.volume_manager Package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.app"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.app</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.cli"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.cli</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.command"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.command</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.command_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.command_process</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.defaults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.defaults</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.exceptions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.exceptions</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.firmware"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.firmware</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.help"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.help</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.kiwi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.kiwi</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.logger"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.logger</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.mount_manager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.mount_manager</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.path"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.path</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.privileges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.privileges</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.runtime_checker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.runtime_checker</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.runtime_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.runtime_config</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.version"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.version</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.xml_description"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.xml_description</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi.xml_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.xml_state</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/api/kiwi.html#module-kiwi">Module Contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="development/schema.html">Schema Documentation 7.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="development/schema_extensions.html">Extending KIWI with Custom Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="development/schema_extensions.html#the-extension-section">The &lt;extension&gt; Section</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/schema_extensions.html#relax-ng-schema-for-the-extension">RELAX NG Schema for the Extension</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/schema_extensions.html#extension-schema-in-xml-catalog">Extension Schema in XML catalog</a></li>
<li class="toctree-l3"><a class="reference internal" href="development/schema_extensions.html#using-the-extension">Using the Extension</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="development.html#fork-the-upstream-kiwi-repository">Fork the upstream KIWI repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="development.html#create-a-local-clone-of-the-forked-kiwi-repository">Create a local clone of the forked KIWI repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="development.html#install-required-operating-system-packages">Install Required Operating System Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="development.html#create-a-python-virtual-development-environment">Create a Python Virtual Development Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="development.html#running-the-unit-tests">Running the Unit Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="development.html#create-a-branch-for-each-feature-or-bugfix">Create a Branch for each Feature or Bugfix</a></li>
<li class="toctree-l2"><a class="reference internal" href="development.html#coding-style">Coding Style</a><ul>
<li class="toctree-l3"><a class="reference internal" href="development.html#documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="development.html#additional-information">Additional Information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="development.html#signing-git-patches">Signing Git Patches</a></li>
<li class="toctree-l3"><a class="reference internal" href="development.html#bumping-the-version">Bumping the Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="development.html#creating-a-rpm-package">Creating a RPM Package</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">kiwi</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Working with KIWI</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/working_with_kiwi.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="working-with-kiwi">
<h1>Working with KIWI<a class="headerlink" href="#working-with-kiwi" title="Permalink to this headline">¶</a></h1>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p><strong>Abstract</strong></p>
<p>The following sections describe the general workflow of building
appliances with KIWI 9.18.34.</p>
</div>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="working_with_kiwi/xml_description.html">The Image Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_kiwi/xml_description.html#the-image-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">image</span></code> Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_kiwi/xml_description.html#the-description-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">description</span></code> Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_kiwi/xml_description.html#the-preferences-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">preferences</span></code> Element</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_kiwi/xml_description.html#image-profiles">Image Profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_kiwi/xml_description.html#adding-users">Adding Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_kiwi/xml_description.html#defining-repositories-and-adding-or-removing-packages">Defining Repositories and Adding or Removing Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_kiwi/shell_scripts.html">User Defined Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_kiwi/runtime_configuration.html">The Runtime Configuration File</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_kiwi/customize_the_boot_process.html">Customizing the Boot Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_kiwi/legacy_kiwi.html">Legacy KIWI vs. Next Generation</a></li>
</ul>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>KIWI builds so-called <em>system images</em> (a fully installed and optionally
configured system in a single file) of a Linux distribution in two steps (for
further details, see <a class="reference internal" href="#working-with-kiwi-image-building-process"><span class="std std-ref">Image Building Process</span></a>):</p>
<ol class="arabic simple">
<li><p><em>Prepare operation</em>: generate an <em>unpacked image tree</em> of your
image. The unpacked tree is a directory containing the future file
system of your image, generated from your image description.</p></li>
<li><p><em>Create operation</em>: the unpacked tree generated in step 1 is packaged
into the format required for the final usage (e.g. a <code class="docutils literal notranslate"><span class="pre">qcow2</span></code> disk
image to launch the image with QEMU).</p></li>
</ol>
<p>KIWI executes these steps using the following components, which it expects
to find in the <em>description directory</em>:</p>
<ol class="arabic">
<li><p><code class="file docutils literal notranslate"><span class="pre">config.xml</span></code>: <a class="reference internal" href="working_with_kiwi/xml_description.html#xml-description"><span class="std std-ref">The Image Description</span></a></p>
<p>This XML file contains the image description, which is a collection of
general settings of the final image, like the partition table, installed
packages, present users, etc.</p>
<p>The filename <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> is not mandatory, the image description
file can also have an arbitrary name plus the <code class="file docutils literal notranslate"><span class="pre">*.kiwi</span></code> extension.
KIWI first looks for a <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> file. If it cannot be found,
it picks the first <code class="file docutils literal notranslate"><span class="pre">*.kiwi</span></code> file.</p>
</li>
<li><p><code class="file docutils literal notranslate"><span class="pre">config.sh</span></code> and <code class="file docutils literal notranslate"><span class="pre">images.sh</span></code>:
<a class="reference internal" href="working_with_kiwi/shell_scripts.html#working-with-kiwi-user-defined-scripts"><span class="std std-ref">User Defined Scripts</span></a></p>
<p>If present, these configuration shell scripts run at the end of the
<em>prepare operation</em> (<code class="file docutils literal notranslate"><span class="pre">config.sh</span></code>) or at the beginning of the
<em>create operation</em> (<code class="file docutils literal notranslate"><span class="pre">images.sh</span></code>). They can be used to fine tune
the image in ways that are not possible via the settings provided in
<code class="file docutils literal notranslate"><span class="pre">config.xml</span></code>.</p>
</li>
<li><p>Overlay tree directory</p>
<p>The <em>overlay tree</em> is a folder (called <code class="file docutils literal notranslate"><span class="pre">root</span></code>) or a tarball
(called <code class="file docutils literal notranslate"><span class="pre">root.tar.gz</span></code>) that contains files and directories that
will be copied into the <em>unpacked image tree</em> during the <em>Prepare
operation</em>.
The copying is executed after all the packages included in
<code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> have been installed. Any already present files are
overwritten.</p>
</li>
<li><p>CD root user data</p>
<p>For live ISO images and install ISO images an optional archive
is supported. This is a tar archive matching the name
<code class="file docutils literal notranslate"><span class="pre">config-cdroot.tar[.compression_postfix]</span></code>.</p>
<p>If present, the archive will be unpacked as user data on the ISO
image. For example, this is used to add license files or user
documentation. The documentation can then be read directly from the
CD/DVD without booting from the media.</p>
</li>
<li><p>Archives included in the <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> file.</p>
<p>The archives that are included in <code class="xref py py-obj docutils literal notranslate"><span class="pre">&lt;packages&gt;</span></code> using the <code class="xref py py-obj docutils literal notranslate"><span class="pre">&lt;archive&gt;</span></code>
element (see <a class="reference internal" href="working_with_kiwi/xml_description.html#xml-description-archive-element"><span class="std std-ref">The archive element</span></a>):</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;packages</span> <span class="na">type=</span><span class="s">&quot;image&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;archive</span> <span class="na">name=</span><span class="s">&quot;custom-archive.tgz&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/packages&gt;</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="image-building-process">
<span id="working-with-kiwi-image-building-process"></span><h2>Image Building Process<a class="headerlink" href="#image-building-process" title="Permalink to this headline">¶</a></h2>
<p>KIWI creates images in a two step process: The first step, the <em>prepare</em>
operation, generates a so-called <em>unpacked image tree</em> (directory) using
the information provided in the <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> configuration file
(see <a class="reference internal" href="working_with_kiwi/xml_description.html#xml-description"><span class="std std-ref">The Image Description</span></a>)</p>
<p>The second step, the <em>create</em> operation, creates the <em>packed image</em> or
<em>image</em> in the specified format based on the unpacked image tree and the
information provided in the <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> configuration file.</p>
<div class="figure align-center" id="id1">
<img alt="Image Creation Architecture" src="_images/intro.png" />
<p class="caption"><span class="caption-text">Image Creation Architecture</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="the-prepare-step">
<span id="prepare-step"></span><h3>The Prepare Step<a class="headerlink" href="#the-prepare-step" title="Permalink to this headline">¶</a></h3>
<p>As the first step, KIWI creates an <em>unpackaged image tree</em>, also called “root tree”. This
directory will be the installation target for software packages to be
installed during the image creation process.</p>
<p>For the package installation, KIWI relies on the package manager specified
in the <code class="docutils literal notranslate"><span class="pre">packagemanager</span></code> element in <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> (see
<a class="reference internal" href="working_with_kiwi/xml_description.html#xml-description-preferences-common-elements"><span class="std std-ref">Common Elements</span></a>). KIWI supports the
following package managers: <code class="docutils literal notranslate"><span class="pre">dnf</span></code>, <code class="docutils literal notranslate"><span class="pre">zypper</span></code> (default) and <code class="docutils literal notranslate"><span class="pre">apt-get</span></code>.</p>
<p>The prepare step consists of the following substeps:</p>
<ol class="arabic">
<li><p><strong>Create Target Root Directory</strong></p>
<p>KIWI aborts with an error if the target root tree already exists to
avoid accidental deletion of an existing unpacked image.</p>
</li>
<li><p><strong>Install Packages</strong></p>
<p>First, KIWI configures the package manager to use the repositories
specified in the configuration file, via the command line, or
both. After the repository setup, the packages specified in the
<code class="docutils literal notranslate"><span class="pre">bootstrap</span></code> section of the image description are installed in a
temporary directory external to the target root tree. This establishes
the initial environment to support the completion of the process in a
chroot setting. The essential packages are <code class="docutils literal notranslate"><span class="pre">filesystem</span></code> and
<code class="docutils literal notranslate"><span class="pre">glibc-locale</span></code> to specify as part of the bootstrap. The dependency
chain of these two packages is usually sufficient to populate the
bootstrap environment with all required software to support the
installation of packages into the new root tree. The aforementioned two
packages might not be enough for every distribution.  Consult the
<a class="reference external" href="https://github.com/OSInside/kiwi-descriptions/">kiwi-descriptions repository</a> containing examples for
various Linux distributions.</p>
<p>The installation of software packages through the selected package
manager may install unwanted packages. Removing these packages can be
accomplished by marking them for deletion in the image description, see
<a class="reference internal" href="working_with_kiwi/xml_description.html#xml-description-adding-and-removing-packages"><span class="std std-ref">Adding and removing packages</span></a>.</p>
</li>
<li><p><strong>Apply the Overlay Tree</strong></p>
<p>Next, KIWI applies all files and directories present in the overlay
directory named <code class="file docutils literal notranslate"><span class="pre">root</span></code> or in the compressed overlay
<code class="file docutils literal notranslate"><span class="pre">root.tar.gz</span></code> to the target root tree. Files already present in
the target root directory are overwritten. This allows you to
overwrite any file that was installed by one of the packages during the
installation phase.</p>
</li>
<li><p><strong>Apply Archives</strong></p>
<p>All archives specified in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">archive</span></code> element of the
<code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> file are applied in the specified order (top to
bottom) after the overlay tree copy operation is complete (see
<a class="reference internal" href="working_with_kiwi/xml_description.html#xml-description-archive-element"><span class="std std-ref">The archive element</span></a>). Files and directories are
extracted relative to the top level of the new root tree. As with the
overlay tree, it is possible to overwrite files already existing in the
target root tree.</p>
</li>
<li><p><strong>Execute the user-defined script</strong> <code class="file docutils literal notranslate"><span class="pre">config.sh</span></code></p>
<p>At the end of the preparation stage the script <code class="file docutils literal notranslate"><span class="pre">config.sh</span></code> is
executed (if present). It is run in the top level directory of the
target root tree. The script’s primary function is to complete the
system configuration, for example, to activate services. See
<a class="reference internal" href="working_with_kiwi/shell_scripts.html#image-customization-config-sh"><span class="std std-ref">Image Customization via the config.sh Shell Script</span></a> section for further details.</p>
</li>
<li><p><strong>Modify the Root Tree</strong></p>
<p>The unpacked image tree is now finished to be converted into the final
image in the <em>create step</em>. It is possible to make manual modifications
to the unpacked tree before it is converted into the final image.</p>
<p>Since the unpacked image tree is just a directory, it can be modified
using the standard tools. Optionally, it is also possible to “change
root (<strong class="command">chroot</strong>)” into it, for instance to invoke the package
manager. Beside the standard file system layout, the unpacked image tree
contains an additional directory named <code class="file docutils literal notranslate"><span class="pre">/image</span></code> that is not
present in a regular system. It contains information KIWI requires
during the create step, including a copy of the <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> file.</p>
<p>By default, KIWI will not stop after the <em>prepare step</em> and will
directly proceed with the <em>create step</em>. Therfore to perform manual
modifications, proceed as follows:</p>
<div class="highlight-shell-session notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> kiwi-ng system prepare <span class="nv">$ARGS</span>
<span class="gp">$</span> <span class="c1"># make your changes</span>
<span class="gp">$</span> kiwi-ng system create <span class="nv">$ARGS</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Modifications of the unpacked root tree</p>
<p>Do not make any changes to the system, since they are lost when
re-running the <code class="docutils literal notranslate"><span class="pre">prepare</span></code> step again. Additionally, you may
introduce errors that occur during the <code class="docutils literal notranslate"><span class="pre">create</span></code> step which are
difficult to track. The recommended way to apply changes to the
unpacked image directory is to change the configuration and re-run
the <code class="docutils literal notranslate"><span class="pre">prepare</span></code> step.</p>
</div>
</li>
</ol>
</div>
<div class="section" id="the-create-step">
<span id="create-step"></span><h3>The Create Step<a class="headerlink" href="#the-create-step" title="Permalink to this headline">¶</a></h3>
<p>KIWI creates the final image during the <em>create step</em>: it converts the
unpacked root tree into one or multiple output files appropriate for the
respective build type.</p>
<p>It is possible to create multiple images from the same unpacked
root tree, for example, a self installing OEM
image and a virtual machine image from the same image description. The only
prerequisite is that both image types are specified in <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code>.</p>
<p>During the <em>create step</em> the following operations are performed by KIWI:</p>
<ol class="arabic">
<li><p><strong>Execute the User-defined Script</strong> <code class="file docutils literal notranslate"><span class="pre">images.sh</span></code></p>
<p>At the beginning of the image creation process the script named
<code class="file docutils literal notranslate"><span class="pre">images.sh</span></code> is executed (if present). It is run in the top level
directory of the unpacked root tree. The script is usually used to
remove files that are no needed in the final image. For example, if an
appliance is being built for a specific hardware, unnecessary kernel
drivers can be removed using this script.</p>
<p>See <a class="reference internal" href="working_with_kiwi/shell_scripts.html#image-customization-images-sh"><span class="std std-ref">Image Customization via the images.sh Shell Script</span></a> for further details.</p>
</li>
<li><p><strong>Create the Requested Image Type</strong></p>
<p>KIWI converts the unpacked root into an output format appropriate for
the requested build type.</p>
</li>
</ol>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="working_with_kiwi/xml_description.html" class="btn btn-neutral float-right" title="The Image Description" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Marcus Schäfer

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>